fmm_reduce_kernel testbench

=== Handcrafted (k1=5,k2=1) ===
Input (rows=6 cols=8 t=0 tcap=64)
    1    2    3    0    0    0    0    0
    1    2    3    0    0    0    0    0
    0    0    0    4    1    2    0    0
    0    0    0   -4   -1   -2    0    0
    0    0    0    0    0    0    7    0
    0    0    0    0    0    0    0    9
Additions before: 6
Kernel output (original region) (rows=6 cols=8 t=0 tcap=64)
    1    2    3    0    0    0    0    0
    1    2    3    0    0    0    0    0
    0    0    0    4    1    2    0    0
    0    0    0   -4   -1   -2    0    0
    0    0    0    0    0    0    7    0
    0    0    0    0    0    0    0    9
CPU reference (original region) (rows=6 cols=8 t=2 tcap=64)
    0    0    0    0    0    0    0    0
    0    0    0    0    0    0    0    0
    0    0    0    0    0    0    0    0
    0    0    0    0    0    0    0    0
    0    0    0    0    0    0    7    0
    0    0    0    0    0    0    0    9
Additions after (original region) — kernel: 6  CPU ref: 0
CPU full additions (incl. t-space): 2
FAIL: original-region matrix mismatch.
FAIL: addition count mismatch.

=== Random 16x32 (k1=5,k2=1) ===
Input (rows=16 cols=32 t=0 tcap=64)
    0    0    0    0    0    0    0    0    0    0    0    0   -5    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0   -1    0    0    0
    0    0    0    0    0   -3    0    0    0    0    0   -1    0    0    0    0    0    0    0    0    3    0    0    0    0    4    0   -3    0    0    0    0
    0    0    1    0    0    0    0    0    0   -4    0    0    0    0    0    0    0    0    0    0    0    0    0    0   -6    0    0    0    0    5    0    0
    0    3    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    4    0    0    0    0   -2    0    0    0    0   -6
    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0
    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0   -4    0   -5    0   -4    0    0    0    0    6    0    0    0    0    0    0    0
    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0
    0    0    0   -2    0    0    2    0    0    0    0    0    0    0    0    5    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0
    0    0    0    0    0    0    0    0    0    0    0    5    0    0    0    0    0    0    0    0    0    2    0    0    0    0   -5    0    0    0    0    0
   -3    0    0    0    0    0    0    4    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0
    0    0    0    0    0    0    0    0    0   -6    0    0    4    0    2    0    0    0    0    0    0    0    0    0    0    0    0    4    0    0    0    0
    0    0    0    0   -5    0    0    0   -5    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    6    0    0
    0    0   -2    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    4    0    0    0    0    0    0    0    0    0
    0    0    0    0    0   -1    0    0    0    0    0    0   -6    2    0    0    0    0    0   -2    0    0    0    0    0    0    0    0   -1    0    0    0
    0    6    0    0    0    0    6    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0
    0    0    0    0    0   -3    0    0    0    0    0    0    0    0    0    0    0    0   -5    0   -4    0    6    0    0    0    0    0    0    0    3    0
Additions before: 19
Kernel output (original region) (rows=16 cols=32 t=0 tcap=64)
    0    0    0    0    0    0    0    0    0    0    0    0   -5    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0   -1    0    0    0
    0    0    0    0    0   -3    0    0    0    0    0   -1    0    0    0    0    0    0    0    0    3    0    0    0    0    4    0   -3    0    0    0    0
    0    0    1    0    0    0    0    0    0   -4    0    0    0    0    0    0    0    0    0    0    0    0    0    0   -6    0    0    0    0    5    0    0
    0    3    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    4    0    0    0    0   -2    0    0    0    0   -6
    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0
    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0   -4    0   -5    0   -4    0    0    0    0    6    0    0    0    0    0    0    0
    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0
    0    0    0   -2    0    0    2    0    0    0    0    0    0    0    0    5    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0
    0    0    0    0    0    0    0    0    0    0    0    5    0    0    0    0    0    0    0    0    0    2    0    0    0    0   -5    0    0    0    0    0
   -3    0    0    0    0    0    0    4    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0
    0    0    0    0    0    0    0    0    0   -6    0    0    4    0    2    0    0    0    0    0    0    0    0    0    0    0    0    4    0    0    0    0
    0    0    0    0   -5    0    0    0   -5    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    6    0    0
    0    0   -2    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    4    0    0    0    0    0    0    0    0    0
    0    0    0    0    0   -1    0    0    0    0    0    0   -6    2    0    0    0    0    0   -2    0    0    0    0    0    0    0    0   -1    0    0    0
    0    6    0    0    0    0    6    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0
    0    0    0    0    0   -3    0    0    0    0    0    0    0    0    0    0    0    0   -5    0   -4    0    6    0    0    0    0    0    0    0    3    0
CPU reference (original region) (rows=16 cols=32 t=0 tcap=64)
    0    0    0    0    0    0    0    0    0    0    0    0   -5    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0   -1    0    0    0
    0    0    0    0    0   -3    0    0    0    0    0   -1    0    0    0    0    0    0    0    0    3    0    0    0    0    4    0   -3    0    0    0    0
    0    0    1    0    0    0    0    0    0   -4    0    0    0    0    0    0    0    0    0    0    0    0    0    0   -6    0    0    0    0    5    0    0
    0    3    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    4    0    0    0    0   -2    0    0    0    0   -6
    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0
    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0   -4    0   -5    0   -4    0    0    0    0    6    0    0    0    0    0    0    0
    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0
    0    0    0   -2    0    0    2    0    0    0    0    0    0    0    0    5    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0
    0    0    0    0    0    0    0    0    0    0    0    5    0    0    0    0    0    0    0    0    0    2    0    0    0    0   -5    0    0    0    0    0
   -3    0    0    0    0    0    0    4    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0
    0    0    0    0    0    0    0    0    0   -6    0    0    4    0    2    0    0    0    0    0    0    0    0    0    0    0    0    4    0    0    0    0
    0    0    0    0   -5    0    0    0   -5    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    6    0    0
    0    0   -2    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    4    0    0    0    0    0    0    0    0    0
    0    0    0    0    0   -1    0    0    0    0    0    0   -6    2    0    0    0    0    0   -2    0    0    0    0    0    0    0    0   -1    0    0    0
    0    6    0    0    0    0    6    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0
    0    0    0    0    0   -3    0    0    0    0    0    0    0    0    0    0    0    0   -5    0   -4    0    6    0    0    0    0    0    0    0    3    0
Additions after (original region) — kernel: 19  CPU ref: 19
CPU full additions (incl. t-space): 19
PASS: kernel original-region matches CPU reference.

=== Random 32x64 (k1=5,k2=1) ===
Input (rows=32 cols=64 t=0 tcap=64)
   -2    0    0    0    0    0    0    0    0    1    0    0    0    0    0    1    0    0   -2    0    0    0    0    0   -2    0    0    0    0    3    0    0    0   -2    0   -3    0    0    0    0    0    0    0    1    0    1    0    0    0    0    0    3    0    0    0    0   -2    0    0    0    0    0    0    0
    0   -3    0    0   -3    0    0    0    0    0    0    0    0    3    0    0    0    0    0    0    0    0    0    0    0   -2    0    0    0    0    0    0    0    0    0    0    0    0    0    0    3    0    0    0    0    0    0    0    1    0    0    0    0    0    0    0    1    0    0    0    0    0    0    0
    0    0    0    0    0    0    0   -2    0    0    0    0    0    0    0    0   -3   -2   -1    0    0    0    0    0   -2    0   -1    0    0    0   -1    0    0    0    0    0    0    0    3    0    0    0    0    0    0    0    0    0    0    0    0   -3    0   -3    3    0    0    0    0    0    0    0    0    1
   -3    0   -3    0    0    2    0    0    0   -3    0   -3    0    0    3    0    0    0    0    1    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    1    0   -2    0   -3    0    0    0    3    0    0    0
    0    0    0    0    0    0    0    0    0    0    2    3    0    0    0    0    0    0    0    3    0    0    0    0    0    2   -1    0    0    2    0    0    0    0    2    0    3    0    0    0    0    0    0    0    0    0    0    0    0    0   -1    0    0    0    0    0    0    0    0    0    0    0    0    0
    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0   -2    0    0    0    0    1    0    0    0    0    0    0    0    1    0    0    0    0    1    0    0    0    0    0    0    0    3    1    0    0    0    1    0    0    0   -3    2    2    0    0    0    0    0    0    0   -2    0   -1    0
    0    0    0    0    0    3    0    0    0    0    0    0    0    0    0    0    0    0   -3    0   -1    0    0    0    0    0    0    0    0    0    0    2    0    0    0    0    0    0   -2    0    3    0    0    0    0    1    0    0    0    0    0    0    0    0    0    0   -2    0   -2    0    0    0    0   -3
    0    0   -3    0   -3    0    0    0    0    0    0   -2    0   -2    0    0    0    0    0   -2    0    2   -3   -1    0    0    2   -3   -3    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0   -1    0    0    3    0    2   -1    0    0    2    0    0    0    0    0    0    0   -3    0    0
    0    0   -3    0    0    0    0    1    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0   -3    0    0    0    0    0    0    0    0    0    0    0    0   -1    0    3    0    0    3    0    0    0    1    0    0    0    1    0    0    0    1    0    0    0    0    0   -2    2    0    0
    0    0    0    0    0    0    0    0    0    0    0    0    0    0   -2    0    0    0    0    0    0    0    0    1    2    1    0    3    0    0    0    0    0    0    0    0    0    0    0   -1    0    0    0    0    0    0    0    0    0   -1    0    3   -2    0   -1    3    0    0    2    0    0    0   -3    2
    2    0    0    0   -1   -1    1    0    0    1    0    2    0   -1    0    0    0    0    0    0    0    0    1    1    0    0    3    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0   -2    0   -3    0    0    0    0    0    0    0    0    2    0    0   -1
   -1    0    0    0    0    0    0    0    0    0    0    3   -2    0    0    2    0    0    0    0    0    0    0    0    0    0    0    0   -2    0    0    0    0    0    0    3    0    0    0    0    0    0    0    0    0    0    0    3    2   -2    0    0   -3    0    0    0    0    0   -1   -2    0    0    0   -2
    0   -3    0    0   -1    0    0    0    0    0   -3    0    0    0    0   -1    0    0   -3    0    0    2    0    0    0    0   -2   -2    0    0   -3    0    0    0    0    0    0    0    0    0    0   -1    0    0    0    0    1    0   -3    0    0    3    0    0    0    0    0    0    0    0    0    0    0    0
    0    0    0   -2    0    0    0    0    0    0    0    0   -3    0    0    0    0    0    0    0    0   -2    0    0    0    0    0    0    0    1    0    0    0    2   -3    0    0    0    0    0    0    0    0    0   -2    0    0    3   -2    0    0    0    0    3    0    0    0    0    0   -2    3    0    0    0
    0    0    0    0    0    0    0    0   -1    2    0    0    0    0    0    3    0    0    0    0    0    0   -3    2    0    0    0    0    0   -2    3    0    0    0    0    0    0    0    0    0    0    1    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    2
    0    0    0    0    0    1    0   -1   -1    0    1    0    0    0    0    0    1    0    2    0    0    3   -3    1    0    0   -3    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    1    0    0    0    0    0   -1    0    0    1    0    0    0    0    0    0    0    3    0    0    0    0
    0   -2    0    0    0    0    1    0    0    0    3    0    3    0    0    0    0    3    0    2    0    1    0    0    0    0    0    0    0    0    0    0    0    1    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0   -2    0    0
    0    0   -1   -3    0    0    3   -3    0    1    0    0    1    0    0    2    0    0    0    0    0    0    0    0    2    0    0    0   -1    0    0    0    0    0   -3   -2    0    0    0    0    0    0    0    0    0    0    0    0    0    0   -2    0    0    0    0    0    0    1   -2    0    0    0    0    0
    0    2    0    0    0    0    0    0    0   -2    2    0    0    0    0    0    0    2   -2    0    0    0    0   -1    0    0    1    0    0    0    0    0    0    0    3    0    0    0   -3   -2    0    0    0    0    0    1    0    0    0    0    0    0    1    0   -3    0    0    0    0    0    1    0    0    0
    0    0    0    0    0    2   -2    0   -1    1    0   -3    0    1    0    0    0    0    0    0    3    1    0   -1   -1    0    0    0    0    0    0   -3    2    0    0    0    0    0    0    0    0    0    0    0    0    0    0   -1    0    0    1    0    0    0    0    0    0    0   -3    0    0    0    0   -1
    3   -2    0    0   -2   -3    0    0    0    0    0    0    0    0    0    0    0    0    1    0    0    0    0    0    0    0    0    1    0    0    0    0    0    0    0    0    0    0    0    0    0   -3    0    0   -1    0    1    0    0    0    0    0    3    0    0   -1   -3    0    0    0    0    0    0    0
    0    0    0    0    0    0    1    0    0    0    0    0    0    3    0    0    0    0    2    0    3    0    0    0    0    2    0    1    1    0    3    1    0    0    3    0    0    0    0   -2    0   -1    0    0    0    0    0    0   -1   -3    0    0    0    0    0    2    0    0    0    0    0    0    0    0
    0    0    0    0    0    0    0   -3    0    0    0    1    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    3    2    0    0    0    0    2    0    0    0    0    0    0    0    0    0    0    0    0   -3    0    0    1    0    3    0    0    0    0    0    0    0    1    0   -3    1    0
    0    0    3    0    0    0    0    0    0    0    3    0    0    0    0    0    0    0    0    0    2    0    0    3    0    0    0    0    0    0    0    0    0    0    0    1    0    0    0    0    0    0    0    0    0    0    0    0   -2    0   -2    0   -1    0    0    3    0    0    3    0    0    0    0    0
    0    0    0    0    0   -1    2    0    0   -3   -1    0    0    0   -2    1    0   -2   -1    0    0    0    0    0    0    0    0    0    0    0   -3    0   -2    0    0    0   -2    0    0    0    0    0    3    0   -2    0    0   -1    0    0    0    0    1    0    0    0    0    2    0    0    0    0    0    0
    0    0   -1   -1    0    0    0    0    0   -2    0    0    0    0    0    0    0    0    0    0    0    0   -2    0    0   -2    0    0    0    0    0    0    0    0    3    0    0    0    0    0    0    0    0    0    0   -2    0    2    0    0    0    2    0    0   -2    0    0    0   -2    0    0    0   -2    0
    0    0    0    0    0    0    0    0    0    0    0    0    0   -1   -3    0    0    0   -1    2    0   -1    0    0    0    0    0    0    0    0    0    0    2   -1    0    0    0    2    0    3    2    0    0    2    3    0    0    0    0    0    0   -3    3    0    0    0    0   -1    0    0    0    0    2    0
    0    0    0    0    1    0    0    0    0    0    0    0    0    0    3    0    0    0    0    0    0    0    0    0    0   -2    0    0    0    1    0    0    0    0    2    0    0    0    0    0    0    0    0    0   -2    0    0    0    0    0    2    0    0    0    0   -2    0    1    0    0    0    0   -1    0
    0    0    0    3    0    2    0    2    1    0    0    0    0    0    0    3    0    0    0    1    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    2    0    0    0    0    0    0    0    0    0
    3    0    0    0    0    0    0    0    0    0    0    0    0   -2    3    3    0   -1    3    0    0    0   -2    0   -2    0    0    0    0    0    0    0    0    0    0   -3    0   -3    0    0   -2    0    0    0    0    0    0    1    0    0    0    1    0    0    0    0    0    3    0    0    0    0    0    0
   -2    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    1    1    0   -1    0    0   -3    0    0    0    0    0    0    0    0    0    0    0    3    0    0    0    0   -2    0    0   -3    2    0    0    0    0    0    0    0    0    0    0    0    0    0   -3    0
    0   -2    0    0    0   -2    0    0    0   -1    0    0    0   -3    2    3    0    0    0   -3    0    0   -3    0   -3    0    3    0    0    1    0   -3    0   -1    0    0    0    0    0    0   -1    0    0    2    0    0    0    0    3    0    2    0    0    0    2    0   -3   -3   -2    0    0    1    0    0
